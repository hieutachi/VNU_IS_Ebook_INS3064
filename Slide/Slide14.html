<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INS3064: Session 14: Security Methods</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .slide-container {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .slide {
            display: none;
            padding: 60px 50px;
            min-height: 700px;
            background: white;
            animation: fadeIn 0.5s ease-in;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .slide h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 20px;
            border-bottom: 3px solid #764ba2;
            padding-bottom: 15px;
        }

        .slide h2 {
            color: #764ba2;
            font-size: 1.8em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .slide h3 {
            color: #667eea;
            font-size: 1.3em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .slide p {
            color: #333;
            font-size: 1.05em;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .slide ul, .slide ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        .slide li {
            color: #333;
            font-size: 1.05em;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .slide strong {
            color: #764ba2;
            font-weight: 600;
        }

        .code-block {
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            font-size: 0.95em;
            color: #333;
            white-space: pre-wrap;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #f9f9f9;
        }

        table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        table td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
            color: #333;
        }

        table tr:hover {
            background: #f0f0f0;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 50px;
            background: #f5f5f5;
            border-top: 1px solid #ddd;
        }

        button {
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .slide-counter {
            color: #667eea;
            font-weight: 600;
            font-size: 1.1em;
        }

        .highlight {
            background: #fffacd;
            padding: 2px 6px;
            border-radius: 3px;
            color: #333;
        }

        .box-info {
            background: #e8f4f8;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            color: #333;
        }

        .box-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            color: #333;
        }

        .comparison-table {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .comparison-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .comparison-item h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .header-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .diagram {
            background: #f9f9f9;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-family: monospace;
            color: #333;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="slide-container">
                <!-- Slide 1: Title Slide -->
        <div class="slide active">
            <div class="header-section">
                <h1>üéì INS3064</h1>
                <h2>Multimedia Design & Web Development</h2>
                <p style="font-size: 1.2em; margin-top: 30px; color: #667eea;"><strong>Session 14: Security Methods</strong></p>
            </div>
            <div style="text-align: center; margin-top: 50px;">
                <p style="font-size: 1.1em; margin: 20px 0;">Course Code: <strong>INS3064</strong></p>
                <p style="font-size: 1.1em; margin: 20px 0;">Instructor: <strong>M.Sc. Hieu Ta Chi</strong></p>
                <p style="font-size: 1.1em; margin: 20px 0;">Host Department: <strong>Applied Sciences Department - IS-VNU</strong></p>
            </div>
        </div>
        <!-- Slide 2: 1. SQL INJECTION -->
        <div class="slide">
            <h1>1. SQL INJECTION</h1>
            
<h3>1.1 SQL Injection L√† G√¨?</h3>

<strong>SQL Injection</strong> = K·ªπ thu·∫≠t t·∫•n c√¥ng b·∫±ng c√°ch ch√®n m√£ SQL ƒë·ªôc h·∫°i v√†o input.

<h3>1.2 V√≠ D·ª• T·∫•n C√¥ng</h3>

<div class="code-block">&lt;?php
<p>// ‚ùå Code d·ªÖ b·ªã t·∫•n c√¥ng</p>
<p>$username = $_POST[&#39;username&#39;];</p>
<p>$password = $_POST[&#39;password&#39;];</p>

<p>$sql = &quot;SELECT * FROM users WHERE username = &#39;$username&#39; AND password = &#39;$password&#39;&quot;;</p>
<p>// N·∫øu nh·∫≠p: username = admin&#39; --</p>
<p>// SQL tr·ªü th√†nh: SELECT * FROM users WHERE username = &#39;admin&#39; --&#39; AND password = &#39;&#39;</p>
<p>// =&gt; ƒêƒÉng nh·∫≠p ƒë∆∞·ª£c m√† kh√¥ng c·∫ßn password!</p>
<p>?&gt;</p>
</div>

<h3>1.3 Ph√≤ng Ch·ªëng</h3>

<div class="code-block">&lt;?php
<p>// ‚úÖ S·ª≠ d·ª•ng Prepared Statements</p>
<p>$sql = &quot;SELECT * FROM users WHERE username = ? AND password = ?&quot;;</p>
<p>$stmt = $pdo-&gt;prepare($sql);</p>
<p>$stmt-&gt;execute([$username, $password]);</p>

<p>// ‚úÖ Named parameters</p>
<p>$sql = &quot;SELECT * FROM users WHERE username = :username AND password = :password&quot;;</p>
<p>$stmt = $pdo-&gt;prepare($sql);</p>
<p>$stmt-&gt;execute([</p>
<p>&#39;:username&#39; =&gt; $username,</p>
<p>&#39;:password&#39; =&gt; $password</p>
<p>]);</p>

<p>// ‚úÖ Escape strings (n·∫øu b·∫Øt bu·ªôc d√πng query tr·ª±c ti·∫øp)</p>
<p>$username = $pdo-&gt;quote($username);</p>
<p>?&gt;</p>
</div>

<p>---</p>

        </div>
        <!-- Slide 3: 2. CROSS-SITE SCRIPTING (XSS) -->
        <div class="slide">
            <h1>2. CROSS-SITE SCRIPTING (XSS)</h1>
            
<h3>2.1 XSS L√† G√¨?</h3>

<strong>XSS</strong> = T·∫•n c√¥ng b·∫±ng c√°ch ch√®n m√£ JavaScript ƒë·ªôc h·∫°i v√†o trang web.

<h3>2.2 C√°c Lo·∫°i XSS</h3>

<p>| Lo·∫°i | M√¥ t·∫£ |</p>
<p>|------|-------|</p>
<p>| <strong>Stored XSS</strong> | Script l∆∞u trong database |</p>
<p>| <strong>Reflected XSS</strong> | Script trong URL, ph·∫£n h·ªìi ngay |</p>
<p>| <strong>DOM-based XSS</strong> | Script th·ª±c thi ph√≠a client |</p>

<h3>2.3 V√≠ D·ª• T·∫•n C√¥ng</h3>

<div class="code-block">&lt;?php
<p>// ‚ùå Code d·ªÖ b·ªã t·∫•n c√¥ng</p>
<p>$name = $_GET[&#39;name&#39;];</p>
<p>echo &quot;Hello, $name!&quot;;</p>
<p>// URL: page.php?name=&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</p>
<p>// =&gt; Script ƒë·ªôc h·∫°i ƒë∆∞·ª£c th·ª±c thi!</p>
<p>?&gt;</p>
</div>

<h3>2.4 Ph√≤ng Ch·ªëng</h3>

<div class="code-block">&lt;?php
<p>// ‚úÖ Escape output v·ªõi htmlspecialchars()</p>
<p>$name = $_GET[&#39;name&#39;];</p>
<p>echo &quot;Hello, &quot; . htmlspecialchars($name, ENT_QUOTES, &#39;UTF-8&#39;) . &quot;!&quot;;</p>

<p>// ‚úÖ H√†m helper</p>
<p>function e($string) {</p>
<p>return htmlspecialchars($string, ENT_QUOTES, &#39;UTF-8&#39;);</p>
<p>}</p>

<p>echo &quot;Hello, &quot; . e($name) . &quot;!&quot;;</p>

<p>// ‚úÖ Content Security Policy header</p>
<p>header(&quot;Content-Security-Policy: default-src &#39;self&#39;; script-src &#39;self&#39;&quot;);</p>
<p>?&gt;</p>
</div>

<p>---</p>

        </div>
        <!-- Slide 4: 3. CROSS-SITE REQUEST FORGERY (CSRF) -->
        <div class="slide">
            <h1>3. CROSS-SITE REQUEST FORGERY (CSRF)</h1>
            
<h3>3.1 CSRF L√† G√¨?</h3>

<strong>CSRF</strong> = T·∫•n c√¥ng b·∫±ng c√°ch l·ª´a user th·ª±c hi·ªán h√†nh ƒë·ªông kh√¥ng mong mu·ªën.

<h3>3.2 V√≠ D·ª• T·∫•n C√¥ng</h3>

<div class="code-block">&lt;!-- Trang ƒë·ªôc h·∫°i --&gt;
<p>&lt;img src=&quot;https://bank.com/transfer?to=hacker&amp;amount=1000&quot;&gt;</p>
<p>&lt;!-- N·∫øu user ƒëang ƒëƒÉng nh·∫≠p bank.com, ti·ªÅn s·∫Ω b·ªã chuy·ªÉn! --&gt;</p>
</div>

<h3>3.3 Ph√≤ng Ch·ªëng</h3>

<div class="code-block">&lt;?php
<p>// ‚úÖ T·∫°o CSRF Token</p>
<p>session_start();</p>

<p>function generateCsrfToken() {</p>
<p>if (empty($_SESSION[&#39;csrf_token&#39;])) {</p>
<p>$_SESSION[&#39;csrf_token&#39;] = bin2hex(random_bytes(32));</p>
<p>}</p>
<p>return $_SESSION[&#39;csrf_token&#39;];</p>
<p>}</p>

<p>function verifyCsrfToken($token) {</p>
<p>return isset($_SESSION[&#39;csrf_token&#39;]) &amp;&amp; hash_equals($_SESSION[&#39;csrf_token&#39;], $token);</p>
<p>}</p>
<p>?&gt;</p>

<p>&lt;!-- Trong form --&gt;</p>
<p>&lt;form method=&quot;POST&quot;&gt;</p>
<p>&lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?= generateCsrfToken() ?&gt;&quot;&gt;</p>
<p>&lt;!-- other fields --&gt;</p>
<p>&lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;</p>
<p>&lt;/form&gt;</p>

<p>&lt;?php</p>
<p>// X·ª≠ l√Ω form</p>
<p>if ($_SERVER[&#39;REQUEST_METHOD&#39;] === &#39;POST&#39;) {</p>
<p>if (!verifyCsrfToken($_POST[&#39;csrf_token&#39;] ?? &#39;&#39;)) {</p>
<p>die(&#39;CSRF token validation failed&#39;);</p>
<p>}</p>
<p>// Process form...</p>
<p>}</p>
<p>?&gt;</p>
</div>

<p>---</p>

        </div>
        <!-- Slide 5: 4. PASSWORD SECURITY -->
        <div class="slide">
            <h1>4. PASSWORD SECURITY</h1>
            
<h3>4.1 Hash Password</h3>

<div class="code-block">&lt;?php
<p>// ‚úÖ Hash password khi ƒëƒÉng k√Ω</p>
<p>$password = $_POST[&#39;password&#39;];</p>
<p>$hashedPassword = password_hash($password, PASSWORD_DEFAULT);</p>

<p>// L∆∞u $hashedPassword v√†o database</p>

<p>// ‚úÖ Verify password khi ƒëƒÉng nh·∫≠p</p>
<p>$inputPassword = $_POST[&#39;password&#39;];</p>
<p>$storedHash = $user[&#39;password&#39;];  // T·ª´ database</p>

<p>if (password_verify($inputPassword, $storedHash)) {</p>
<p>// ƒêƒÉng nh·∫≠p th√†nh c√¥ng</p>
<p>} else {</p>
<p>// Sai password</p>
<p>}</p>

<p>// ‚úÖ Ki·ªÉm tra c·∫ßn rehash (khi algorithm thay ƒë·ªïi)</p>
<p>if (password_needs_rehash($storedHash, PASSWORD_DEFAULT)) {</p>
<p>$newHash = password_hash($inputPassword, PASSWORD_DEFAULT);</p>
<p>// Update database v·ªõi $newHash</p>
<p>}</p>
<p>?&gt;</p>
</div>

<h3>4.2 Password Policy</h3>

<div class="code-block">&lt;?php
<p>function validatePassword($password) {</p>
<p>$errors = [];</p>
    
<p>if (strlen($password) &lt; 8) {</p>
<p>$errors[] = &quot;Password must be at least 8 characters&quot;;</p>
<p>}</p>
    
<p>if (!preg_match(&#39;/[A-Z]/&#39;, $password)) {</p>
<p>$errors[] = &quot;Password must contain uppercase letter&quot;;</p>
<p>}</p>
    
<p>if (!preg_match(&#39;/[a-z]/&#39;, $password)) {</p>
<p>$errors[] = &quot;Password must contain lowercase letter&quot;;</p>
<p>}</p>
    
<p>if (!preg_match(&#39;/[0-9]/&#39;, $password)) {</p>
<p>$errors[] = &quot;Password must contain number&quot;;</p>
<p>}</p>
    
<p>if (!preg_match(&#39;/[!@#$%^&amp;*]/&#39;, $password)) {</p>
<p>$errors[] = &quot;Password must contain special character&quot;;</p>
<p>}</p>
    
<p>return $errors;</p>
<p>}</p>
<p>?&gt;</p>
</div>

<p>---</p>

        </div>
        <!-- Slide 6: 5. INPUT VALIDATION & SANITIZATION -->
        <div class="slide">
            <h1>5. INPUT VALIDATION &amp; SANITIZATION</h1>
            
<div class="code-block">&lt;?php
<p>// ‚úÖ Validation</p>
<p>function validateEmail($email) {</p>
<p>return filter_var($email, FILTER_VALIDATE_EMAIL);</p>
<p>}</p>

<p>function validateUrl($url) {</p>
<p>return filter_var($url, FILTER_VALIDATE_URL);</p>
<p>}</p>

<p>function validateInt($value, $min = null, $max = null) {</p>
<p>$options = [];</p>
<p>if ($min !== null) $options[&#39;min_range&#39;] = $min;</p>
<p>if ($max !== null) $options[&#39;max_range&#39;] = $max;</p>
    
<p>return filter_var($value, FILTER_VALIDATE_INT, [&#39;options&#39; =&gt; $options]);</p>
<p>}</p>

<p>// ‚úÖ Sanitization</p>
<p>function sanitizeString($string) {</p>
<p>return htmlspecialchars(trim($string), ENT_QUOTES, &#39;UTF-8&#39;);</p>
<p>}</p>

<p>function sanitizeEmail($email) {</p>
<p>return filter_var($email, FILTER_SANITIZE_EMAIL);</p>
<p>}</p>

<p>function sanitizeUrl($url) {</p>
<p>return filter_var($url, FILTER_SANITIZE_URL);</p>
<p>}</p>

<p>function sanitizeInt($value) {</p>
<p>return filter_var($value, FILTER_SANITIZE_NUMBER_INT);</p>
<p>}</p>
<p>?&gt;</p>
</div>

<p>---</p>

        </div>
        <!-- Slide 7: 6. FILE UPLOAD SECURITY -->
        <div class="slide">
            <h1>6. FILE UPLOAD SECURITY</h1>
            
<div class="code-block">&lt;?php
<p>function secureFileUpload($file, $uploadDir) {</p>
<p>$errors = [];</p>
    
<p>// Ki·ªÉm tra l·ªói upload</p>
<p>if ($file[&#39;error&#39;] !== UPLOAD_ERR_OK) {</p>
<p>return [&#39;error&#39; =&gt; &#39;Upload failed&#39;];</p>
<p>}</p>
    
<p>// Ki·ªÉm tra k√≠ch th∆∞·ªõc (5MB max)</p>
<p>if ($file[&#39;size&#39;] &gt; 5 * 1024 * 1024) {</p>
<p>return [&#39;error&#39; =&gt; &#39;File too large&#39;];</p>
<p>}</p>
    
<p>// Ki·ªÉm tra MIME type</p>
<p>$allowedTypes = [&#39;image/jpeg&#39;, &#39;image/png&#39;, &#39;image/gif&#39;];</p>
<p>$finfo = finfo_open(FILEINFO_MIME_TYPE);</p>
<p>$mimeType = finfo_file($finfo, $file[&#39;tmp_name&#39;]);</p>
<p>finfo_close($finfo);</p>
    
<p>if (!in_array($mimeType, $allowedTypes)) {</p>
<p>return [&#39;error&#39; =&gt; &#39;Invalid file type&#39;];</p>
<p>}</p>
    
<p>// T·∫°o t√™n file an to√†n</p>
<p>$extension = pathinfo($file[&#39;name&#39;], PATHINFO_EXTENSION);</p>
<p>$newName = bin2hex(random_bytes(16)) . &#39;.&#39; . $extension;</p>
<p>$destination = $uploadDir . &#39;/&#39; . $newName;</p>
    
<p>// Di chuy·ªÉn file</p>
<p>if (!move_uploaded_file($file[&#39;tmp_name&#39;], $destination)) {</p>
<p>return [&#39;error&#39; =&gt; &#39;Failed to save file&#39;];</p>
<p>}</p>
    
<p>return [&#39;success&#39; =&gt; true, &#39;filename&#39; =&gt; $newName];</p>
<p>}</p>
<p>?&gt;</p>
</div>

<p>---</p>

        </div>
        <!-- Slide 8: 7. SECURITY HEADERS -->
        <div class="slide">
            <h1>7. SECURITY HEADERS</h1>
            
<div class="code-block">&lt;?php
<p>// Th√™m v√†o ƒë·∫ßu m·ªói page ho·∫∑c trong .htaccess</p>
<p>header(&quot;X-Content-Type-Options: nosniff&quot;);</p>
<p>header(&quot;X-Frame-Options: DENY&quot;);</p>
<p>header(&quot;X-XSS-Protection: 1; mode=block&quot;);</p>
<p>header(&quot;Strict-Transport-Security: max-age=31536000; includeSubDomains&quot;);</p>
<p>header(&quot;Content-Security-Policy: default-src &#39;self&#39;&quot;);</p>
<p>header(&quot;Referrer-Policy: strict-origin-when-cross-origin&quot;);</p>
<p>?&gt;</p>
</div>

<p>---</p>

<p># TH·ª∞C H√ÄNH</p>

        </div>
        <!-- Slide 9: B√ÄI 1: Secure Login Form -->
        <div class="slide">
            <h1>B√ÄI 1: Secure Login Form</h1>
            
<p>üìù <strong>Y√™u c·∫ßu:</strong></p>
<ul><li>CSRF protection</li>
<li>SQL Injection prevention</li>
<li>XSS prevention</li>
<li>Password hashing</li></ul>

        </div>
        <!-- Slide 10: B√ÄI 2: Secure File Upload -->
        <div class="slide">
            <h1>B√ÄI 2: Secure File Upload</h1>
            
<p>üìù <strong>Y√™u c·∫ßu:</strong></p>
<ul><li>Validate file type</li>
<li>Limit file size</li>
<li>Secure filename</li>
<li>Store outside webroot</li></ul>

<p>---</p>

<p># ‚úÖ KI·∫æN TH·ª®C C·∫¶N ƒê·∫†T</p>

<ul><li>[ ] Hi·ªÉu SQL Injection v√† c√°ch ph√≤ng ch·ªëng</li>
<li>[ ] Hi·ªÉu XSS v√† c√°ch ph√≤ng ch·ªëng</li>
<li>[ ] Hi·ªÉu CSRF v√† c√°ch ph√≤ng ch·ªëng</li>
<li>[ ] B·∫£o m·∫≠t password v√† file upload</li></ul>

<p>---</p>

<strong>Ch∆∞∆°ng ti·∫øp theo: [Bu·ªïi 15 - jQuery Introduction ‚Üí](./buoi_15_jquery_intro.md)</strong>

        </div>
        
        <!-- Navigation -->
        <div class="navigation">
            <button id="prevBtn" onclick="changeSlide(-1)">‚Üê Previous</button>
            <span class="slide-counter"><span id="currentSlide">1</span> / <span id="totalSlides">10</span></span>
            <button id="nextBtn" onclick="changeSlide(1)">Next ‚Üí</button>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        const totalSlides = 10;

        function showSlide(n) {
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            if (n > totalSlides) {
                currentSlide = totalSlides;
            }
            if (n < 1) {
                currentSlide = 1;
            }

            slides.forEach(slide => slide.classList.remove('active'));
            slides[currentSlide - 1].classList.add('active');

            document.getElementById('currentSlide').textContent = currentSlide;
            document.getElementById('totalSlides').textContent = totalSlides;

            prevBtn.disabled = currentSlide === 1;
            nextBtn.disabled = currentSlide === totalSlides;
        }

        function changeSlide(n) {
            currentSlide += n;
            showSlide(currentSlide);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });

        showSlide(currentSlide);
    </script>
</body>
</html>